# DataWise Desktop 统一交互规范
版本：v1.0  
日期：2025-11-14  
适用范围：Tauri、egui、tui 三个 UI 框架

---

## 1. 全局快捷键（三端统一）

| 功能 | 快捷键 | 说明 |
|------|--------|------|
| 运行 SQL | `Ctrl+R` | 全局有效，执行当前编辑器中的 SQL |
| 停止查询 | `Ctrl+C` | 全局有效，取消正在执行的任务 |
| 格式化 SQL | `Ctrl+Shift+F` | Tauri/egui 支持，tui 暂缺 |
| 切换到 Table 页 | `Ctrl+1` | 显示结果表格 |
| 切换到 Chart 页 | `Ctrl+2` | 显示图表（如果支持） |
| 切换到 Log 页 | `Ctrl+3` | 显示执行日志 |
| 全屏编辑器 | `F11` | Tauri/egui 支持 |
| 打开文件 | `Ctrl+O` | tui 支持 |
| 退出应用 | `Ctrl+Q` | tui 支持 |

---

## 2. 状态反馈流程

### 2.1 导入文件流程

```
用户拖放/选择文件
  ↓
[验证格式] → 失败 → 显示错误提示（红色）
  ↓ 成功
[开始导入] → 显示进度条（蓝色/绿色）
  ↓
[导入完成] → 显示成功提示 + 刷新文件树
```

**反馈元素**：
- 进度条：显示百分比 + 已处理字节数 / 总字节数
- 成功提示：绿色 toast/横幅，显示"已导入 N 行"
- 错误提示：红色 toast/横幅，显示具体错误信息

### 2.2 SQL 执行流程

```
用户点击 Run 或按 Ctrl+R
  ↓
[禁用 Run 按钮] → 显示"■ Cancel"按钮
  ↓
[执行 SQL] → 显示进度条（0-100%）
  ↓
[执行完成] → 显示结果 + 执行时间
  ↓
[启用 Run 按钮]
```

**反馈元素**：
- 进度条：显示百分比 + 预计剩余时间（ETA）
- 完成提示：显示"Finished in X.XXs"
- 错误提示：在 Log 页显示红色错误信息 + 行号

### 2.3 导出文件流程

```
用户点击 Export
  ↓
[选择导出格式和路径]
  ↓
[开始导出] → 显示进度条
  ↓
[导出完成] → 显示成功提示
```

**反馈元素**：
- 进度条：显示百分比
- 成功提示：绿色提示，显示"Saved to /path/to/file"

---

## 3. 错误处理规范

| 错误类型 | 显示位置 | 样式 | 示例 |
|---------|---------|------|------|
| 文件格式错误 | toast/横幅 | 红色 | "Unsupported format: .xyz" |
| SQL 语法错误 | Log 页 + 行号 | 红色 | "Syntax error at line 3" |
| 导入失败 | toast/横幅 | 红色 | "Failed to import: permission denied" |
| 导出失败 | toast/横幅 | 红色 | "Failed to export: disk full" |

---

## 4. 进度条规范

### 4.1 样式

- **Tauri**：蓝色线性进度条，顶部固定
- **egui**：绿色线性进度条，顶部固定
- **tui**：ASCII 进度条（`████████░░░░░░░░`），Header 区域

### 4.2 显示内容

```
[████████░░░░░░░░] 45% | 234 MB / 512 MB | ETA: 2m 30s
```

---

## 5. 按钮状态规范

| 按钮 | 正常状态 | 执行中 | 禁用 |
|------|---------|--------|------|
| Run | ▶ Run | ■ Cancel | 灰色 |
| Import | + Import | 灰色 | 灰色 |
| Export | ↓ Export | 灰色 | 灰色 |

---

## 6. 文件树交互

- **展开/折叠**：点击文件夹图标
- **拖放导入**：拖放文件到编辑区或文件树
- **右键菜单**：删除表、重命名表（可选）

---

## 7. 编辑器交互

- **语法高亮**：SQL 关键字、字符串、注释
- **自动补全**：表名、列名（可选）
- **行号显示**：便于定位错误
- **多行编辑**：支持 Shift+Enter 换行

---

## 8. 结果展示规范

### 8.1 Table 页

- 虚拟滚动：支持百万行数据
- 列宽自适应
- 排序/筛选（可选）

### 8.2 Chart 页

- 自动选择图表类型（柱状图/折线图/饼图）
- 支持拖放列到行/列/值区域（可选）

### 8.3 Log 页

- 显示执行时间、行数、列数
- 显示错误信息（红色）
- 显示警告信息（黄色）

---

## 9. 响应时间目标

| 操作 | 目标 | 说明 |
|------|------|------|
| 导入 1GB CSV | < 30s | 包括解析和表创建 |
| 渲染 100 万行 | 60 fps | 虚拟滚动 |
| SQL 查询响应 | < 100ms | 简单查询 |
| UI 响应 | < 100ms | 按钮点击、快捷键 |

---

## 10. 无障碍设计

- 所有按钮都有快捷键
- 错误信息清晰明确
- 支持键盘导航
- 高对比度配色


